"use strict";var __rest=this&&this.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]])}return r},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorPicker=void 0;const react_1=__importDefault(require("react")),popover2_1=require("@blueprintjs/popover2"),core_1=require("@blueprintjs/core"),core_2=require("@blueprintjs/core"),react_color_1=require("react-color"),styled_1=__importDefault(require("../utils/styled")),gradient_1=require("../utils/gradient"),DEFAULT_COLORS=["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"].reverse(),getUsedColors=e=>{const t=[];e.pages.forEach((e=>{e.children.forEach((e=>{"text"===e.type&&t.push(e.fill),"svg"===e.type&&t.push(...e.colorsReplace.values())}))}));const r=[];return t.forEach((e=>{if((0,gradient_1.isGradient)(e)){const[t,a,o]=(0,gradient_1.parseColor)(e);r.push(a,o)}else r.push(e)})),[...new Set(r)]},SolidContainer=(0,styled_1.default)("div")`
  padding: 5px;

  & .sketch-picker {
    padding: 0px !important;
    box-shadow: none !important;
    background: none !important;
  }

  & .flexbox-fix {
    border-top: none !important;
  }

  .bp3-dark & .sketch-picker {
    background-color: #394b59;
  }

  .bp3-dark & .sketch-picker label {
    color: #f5f8fa !important;
  }
`,SolidInput=e=>{var{style:t}=e,r=__rest(e,["style"]);return react_1.default.createElement(SolidContainer,{style:t},react_1.default.createElement(react_color_1.SketchPicker,Object.assign({},r)))},LinearGradient=({value:e,onChange:t,store:r})=>{const[a,o,l]=(0,gradient_1.parseColor)(e);return react_1.default.createElement("div",null,react_1.default.createElement("div",{style:{width:"200px",height:"150px"}},react_1.default.createElement("div",{style:{height:"100%",background:e}})),react_1.default.createElement("div",{style:{display:"flex",paddingBottom:"20px",paddingTop:"20px",justifyContent:"space-between"}},react_1.default.createElement(exports.ColorPicker,{value:o,onChange:e=>{t(`linear-gradient(${a}deg,${e},${l})`)},store:r,style:{margin:""}}),react_1.default.createElement(exports.ColorPicker,{value:l,onChange:e=>{t(`linear-gradient(${a}deg,${o},${e})`)},store:r,style:{margin:""}})),react_1.default.createElement("div",{style:{padding:"10px"}},react_1.default.createElement(core_2.Slider,{min:0,max:360,value:a,showTrackFill:!1,labelRenderer:!1,onChange:e=>{t(`linear-gradient(${e}deg,${o},${l})`)}})))},VariantColorInput=({value:e,onChange:t,preset:r,store:a})=>{const[o,l]=react_1.default.useState((0,gradient_1.isGradient)(e)?"gradient":"solid");return react_1.default.createElement("div",{style:{padding:"5px"}},react_1.default.createElement(core_1.Tabs,{id:"TabsExample",selectedTabId:o,onChange:e=>l(e)},react_1.default.createElement(core_1.Tab,{id:"solid",title:"Solid",panel:react_1.default.createElement(SolidInput,{color:e,onChangeComplete:e=>{const{r:r,g:a,b:o,a:l}=e.rgb;t(`rgba(${r},${a},${o},${l})`)},presetColors:r,style:{padding:"0"}})}),react_1.default.createElement(core_1.Tab,{id:"gradient",title:"Linear",panel:react_1.default.createElement(LinearGradient,{value:e,onChange:t,store:a}),panelClassName:"ember-panel"})))},ColorPicker=({value:e,onChange:t,size:r,store:a,gradientEnabled:o,children:l,style:n})=>{const i=r||30,c=a?getUsedColors(a).slice(0,8):[],d=c.concat(DEFAULT_COLORS.slice(0,16-c.length).reverse());return react_1.default.createElement(popover2_1.Popover2,{content:o?react_1.default.createElement(VariantColorInput,{preset:d,value:e,onChange:t,store:a}):react_1.default.createElement(SolidInput,{color:e,onChangeComplete:e=>{const{r:r,g:a,b:o,a:l}=e.rgb;t(`rgba(${r},${a},${o},${l})`)},presetColors:d})},l||react_1.default.createElement("div",{style:Object.assign({width:i+"px",height:i+"px",background:e,marginLeft:"10px",borderRadius:"2px",boxShadow:"0 0 2px grey",marginBottom:"-4px"},n)}))};exports.ColorPicker=ColorPicker,exports.default=exports.ColorPicker;